name: "Research & Content Generation Agent"
description: "An intelligent agent that researches a topic, analyzes information, and generates a comprehensive report"

nodes:
  # Step 1: Prepare research query
  - id: "prepare_query"
    type: "transform"
    config:
      operation: "passthrough"
      input_key: "topic"
      output_key: "research_query"
  
  # Step 2: Perform web search to gather information
  - id: "web_search"
    type: "web_search"
    config:
      query: "Latest information about {topic}"
      max_results: 5
      output_key: "search_results"
  
  # Step 3: Analyze search results and extract key insights
  - id: "analyze_results"
    type: "llm_call"
    config:
      prompt: |
        Analyze the following search results about {topic} and extract:
        1. Key facts and findings
        2. Important trends or developments
        3. Notable statistics or data points
        4. Expert opinions or perspectives
        
        Search Results:
        {search_results}
        
        Provide a structured analysis.
      model: "gpt-4"
      temperature: 0.7
      output_key: "analysis"
  
  # Step 4: Generate comprehensive summary
  - id: "generate_summary"
    type: "llm_call"
    config:
      prompt: |
        Based on the analysis of {topic}, create a comprehensive summary report that includes:
        
        Analysis:
        {analysis}
        
        Format the report with:
        - Executive Summary
        - Key Findings
        - Important Details
        - Conclusion
        
        Make it professional and well-structured.
      model: "gpt-4"
      temperature: 0.8
      output_key: "summary"
  
  # Step 5: Generate actionable insights
  - id: "generate_insights"
    type: "llm_call"
    config:
      prompt: |
        Based on the research about {topic}, generate 3-5 actionable insights or recommendations.
        
        Summary:
        {summary}
        
        Provide insights in a clear, bullet-point format.
      model: "gpt-4"
      temperature: 0.9
      output_key: "insights"
  
  # Step 6: Aggregate all information into final report
  - id: "aggregate_report"
    type: "data_aggregator"
    config:
      inputs:
        - key: "topic"
          label: "Research Topic"
        - key: "summary"
          label: "Summary"
        - key: "insights"
          label: "Key Insights"
      output_key: "final_report"
      format: "structured"
  
  # Step 7: Format and output the final report
  - id: "format_output"
    type: "output"
    config:
      input_key: "final_report"
      format: "json"

edges:
  # Define execution flow (DAG)
  - from: "prepare_query"
    to: "web_search"
  
  - from: "web_search"
    to: "analyze_results"
  
  - from: "analyze_results"
    to: "generate_summary"
  
  - from: "generate_summary"
    to: "generate_insights"
  
  - from: "generate_insights"
    to: "aggregate_report"
  
  - from: "aggregate_report"
    to: "format_output"

input:
  topic: "string"

